(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{137:function(e,t,a){},139:function(e,t,a){"use strict";a.r(t);a(86),a(111);var n=a(0),r=a.n(n),i=a(49),o=a.n(i),s=a(12),l=a.n(s),c=a(19),u=a(20),d=a(24),m=a(21),p=a(25),f=a(1),k=(a(35),a(36)),h=a.n(k),v=a(28),E=a.n(v),b=function(e){var t=e.router,a=e.onRemovableTasks,n=e.removable,i=E()("tasks"),o=i.dispatch,s=i.tasks,l=Object(f.platform)(),c=e.user.id;return r.a.createElement("div",null,r.a.createElement(f.PanelHeader,{left:l!==f.ANDROID&&r.a.createElement(f.HeaderButton,{onClick:function(){return a()}},r.a.createElement(h.a,null))},"\u0417\u0430\u043c\u0435\u0442\u043a\u0438"),r.a.createElement(f.Search,{onChange:function(e){return o("tasks/search",e)}}),r.a.createElement(f.List,null,s.map(function(e,a){return r.a.createElement(f.Cell,{expandable:!0,removable:n,key:a,onRemove:function(){return o("tasks/api/delete",{task:e,user_id:c})},onClick:function(){t.navigate("task",{id:e.id})}},e.text)})))},g=a(22),x=a.n(g),C=a(37),y=a.n(C),O=a(23),T=a.n(O),j=a(51),D=a.n(j),S=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).onClickAddTask=function(){var e=a.props.router,t=a.state.text;if(""!==t){a.setState({error:!1});a.props.tasks;var n=a.props.user.id;a.props.dispatch("tasks/api/add",{user_id:n,text:t}),e.navigateToDefault()}else a.setState({error:!0})},a.onChangeTextTask=function(e){var t=e.target.value;a.setState({text:t})},a.state={text:"",error:!1,textareaHeight:0},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=.8*window.document.body.offsetHeight;this.setState({textareaHeight:e})}},{key:"render",value:function(){var e=this,t=this.props.router,a=Object(f.platform)();return r.a.createElement("div",null,r.a.createElement(f.PanelHeader,{left:r.a.createElement(x.a,{onClick:function(){return t.navigate("tasks")}})},"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435"),r.a.createElement(f.FormLayout,null,!0===this.state.error&&r.a.createElement(f.FormStatus,{title:"\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0435 \u043f\u043e\u043b\u044f",state:"error"},"\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u044f"),r.a.createElement("div",{style:{width:"100%",height:this.state.textareaHeight,boxSizing:"border-box",position:"relative"}},r.a.createElement("textarea",{style:{border:"none",padding:10,fontSize:16,width:"100%",height:this.state.textareaHeight,boxSizing:"border-box"},onChange:this.onChangeTextTask,value:this.state.text,placeholder:"\u0417\u0434\u0435\u0441\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0412\u0430\u0448 \u0442\u0435\u043a\u0441\u0442"}),r.a.createElement("button",{style:{position:"absolute",bottom:10,right:10,borderRadius:17,border:"none",color:"#fff",padding:4,backgroundColor:"var(--button_primary_background)"},onClick:function(){l.a.send("VKWebAppOpenApp",{app_id:6959073,location:"text=".concat(encodeURI(e.state.text))})}},r.a.createElement(D.a,{style:{transform:"rotateZ(90deg)"}}),r.a.createElement(D.a,{style:{transform:"rotateZ(270deg)",marginTop:"-9px",marginLeft:10}})))),r.a.createElement(f.FixedLayout,{vertical:"bottom"},a===f.ANDROID?r.a.createElement(f.Div,{style:{float:"right"}},r.a.createElement(f.Button,{className:"FixedBottomButton",onClick:function(t){return e.onClickAddTask(t)}},r.a.createElement(y.a,null))):r.a.createElement(f.Div,null,r.a.createElement(f.Button,{size:"xl",onClick:function(t){return e.onClickAddTask(t)}},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"))))}}]),t}(r.a.Component),B=T()("tasks",S);var w=function(e){var t=E()("tasks").tasks.filter(function(t){return t.id===Number(e.route.params.id)})[0],a=e.router;return r.a.createElement("div",null,r.a.createElement(f.PanelHeader,{left:r.a.createElement(x.a,{onClick:function(){return a.navigate("tasks")}})},"\u0417\u0430\u043c\u0435\u0442\u043a\u0430"),"undefined"!==typeof t&&r.a.createElement(f.Group,null,r.a.createElement(f.Div,{style:{whiteSpace:"pre-line"}},t.text)))},N=a(84),R=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).onClickEditTask=function(){var e=a.props.router,t=a.state,n=t.id,r=t.text;if(""!==r){a.setState({error:!1});a.props.tasks;var i={id:n,text:r},o=a.props.user.id;a.props.dispatch("tasks/api/edit",{task:i,user_id:o}),e.navigate("task",{id:n})}else a.setState({error:!0})},a.onChangeTextTask=function(e){var t=e.target.value;a.setState({text:t})},a.state={id:null,text:"",error:!1},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.tasks.filter(function(t){return t.id===Number(e.props.route.params.id)})[0];this.setState(Object(N.a)({},t))}},{key:"render",value:function(){var e=this,t=this.props.router,a=Object(f.platform)();return r.a.createElement("div",null,r.a.createElement(f.PanelHeader,{left:r.a.createElement(x.a,{onClick:function(){return t.navigate("task",{id:e.state.id})}})},"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"),r.a.createElement(f.FormLayout,null,!0===this.state.error&&r.a.createElement(f.FormStatus,{title:"\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0435 \u043f\u043e\u043b\u044f",state:"error"},"\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u044f"),r.a.createElement(f.Textarea,{onChange:this.onChangeTextTask,value:this.state.text,placeholder:"\u041d\u0430\u043f\u0438\u0448\u0438, \u0447\u0442\u043e\u0431\u044b \u0442\u044b \u0445\u043e\u0442\u0435\u043b \u0441\u0434\u0435\u043b\u0430\u0442\u044c"})),r.a.createElement(f.FixedLayout,{vertical:"bottom"},a===f.ANDROID?r.a.createElement(f.Div,{style:{float:"right"}},r.a.createElement(f.Button,{className:"FixedBottomButton",onClick:function(){return e.onClickEditTask()}},r.a.createElement(y.a,null))):r.a.createElement(f.Div,null,r.a.createElement(f.Button,{size:"xl",onClick:function(){return e.onClickEditTask()}},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))))}}]),t}(r.a.Component),P=T()("tasks",R),A=a(78),I=a.n(A),F=a(79),H=a.n(F),L=a(38),_=(a(137),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).onRemovableTasks=function(){return a.setState({removable:!a.state.removable})},a.state={currentTaskId:null,removable:!1,user:{id:1}},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;l.a.subscribe(function(t){switch(t.detail.type){case"VKWebAppGetUserInfoResult":e.setState({user:t.detail.data});var a=t.detail.data.id;e.props.dispatch("tasks/api/get",{id:a});break;default:console.log(t.detail.type)}}),l.a.send("VKWebAppGetUserInfo",{})}},{key:"render",value:function(){var e=this,t=this.props,a=t.route,n=t.router,i=Object(f.platform)(),o=a.name;return r.a.createElement(f.Root,{activeView:"tasksView"},r.a.createElement(f.View,{activePanel:o,id:"tasksView"},r.a.createElement(f.Panel,{id:"tasks"},r.a.createElement(b,{user:this.state.user,router:n,removable:this.state.removable,onRemovableTasks:this.onRemovableTasks,setCurrentTaskId:this.setCurrentTaskId}),r.a.createElement(f.FixedLayout,{vertical:"bottom"},i===f.ANDROID?r.a.createElement(f.Div,{style:{float:"right"}},r.a.createElement(f.Button,{className:"FixedBottomButton",onClick:function(){return n.navigate("add")}},r.a.createElement(I.a,null))):r.a.createElement(f.Div,null,r.a.createElement(f.Button,{size:"xl",onClick:function(){return n.navigate("add")}},"\u041d\u043e\u0432\u0430\u044f \u0437\u0430\u043c\u0435\u0442\u043a\u0430")),i===f.ANDROID&&r.a.createElement(f.Div,null,r.a.createElement(f.Button,{className:"FixedBottomButton",onClick:function(){return e.onRemovableTasks()}},r.a.createElement(h.a,null))))),r.a.createElement(f.Panel,{id:"task"},r.a.createElement(w,{router:n,route:a}),r.a.createElement(f.FixedLayout,{vertical:"bottom"},i===f.ANDROID?r.a.createElement(f.Div,{style:{float:"right"}},r.a.createElement(f.Button,{className:"FixedBottomButton",onClick:function(){return n.navigate("edit",{id:a.params.id})}},r.a.createElement(H.a,null))):r.a.createElement(f.Div,null,r.a.createElement(f.Button,{size:"xl",onClick:function(){return n.navigate("edit",{id:a.params.id})}},"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c")))),r.a.createElement(f.Panel,{id:"edit",theme:"white"},r.a.createElement(P,{router:n,route:a,user:this.state.user})),r.a.createElement(f.Panel,{id:"add",theme:"white"},r.a.createElement(B,{user:this.state.user,router:n,route:a}))))}}]),t}(r.a.Component)),z=T()("tasks",function(e){return r.a.createElement(L.a,{nodeName:""},function(t){var a=t.route;return r.a.createElement(_,Object.assign({route:a},e))})}),V=a(29),J=a(81),K=a(82),W=[{name:"tasks",path:"/tasks"},{name:"task",path:"/task/:id"},{name:"edit",path:"/edit/:id"},{name:"add",path:"/add"}];var G=a(83),M=a.n(G),U="https://azshara-api.com",Z=a(50),q=a.n(Z);l.a.send("VKWebAppInit",{});var Q=function(){var e=Object(V.b)(W,{defaultRoute:"tasks"});return e.usePlugin(J.a),e.usePlugin(Object(K.a)({useHash:!0})),e}(),X=M()([function(e){e.on("@init",function(){return{tasks:[]}}),e.on("tasks/save",function(e,t){return e.tasks,{tasks:t.tsks}}),e.on("tasks/search",function(e,t){var a=e.tasks,n=t.toLowerCase();return""==t.trim()?a:a.filter(function(e){return e.task.text.toLowerCase().indexOf(n)>-1})}),e.on("tasks/api/get",function(t,a){t.tasks;var n=a.id;fetch("".concat(U,"/notes/").concat(n)).then(function(e){return e.json()}).then(function(t){var a=t.notes;e.dispatch("tasks/save",{tsks:a})})}),e.on("tasks/api/add",function(t,a){var n=t.tasks;fetch("".concat(U,"/add"),{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(t){if("undefined"!==typeof t.id){a.id=t.id;var r=n.concat([a]);e.dispatch("tasks/save",{tsks:r})}})}),e.on("tasks/api/delete",function(e,t){var a=e.tasks,n=t.task,r=t.user_id;fetch("".concat(U,"/delete"),{method:"POST",body:JSON.stringify({id:n.id,user_id:r}),headers:{"Content-Type":"application/json"}});var i=n.id;return{tasks:a.filter(function(e){return e.id!==i})}}),e.on("tasks/api/edit",function(e,t){var a=e.tasks,n=t.task,r=t.user_id;return fetch("".concat(U,"/edit"),{method:"POST",body:JSON.stringify({id:n.id,text:n.text,user_id:r}),headers:{"Content-Type":"application/json"}}),{tasks:a.map(function(e){return e.id===n.id&&(e=n),e})}})}]);Q.start(function(){o.a.render(r.a.createElement(L.b,{router:Q},r.a.createElement(q.a.Provider,{value:X},r.a.createElement(z,{router:Q}))),document.getElementById("root"))})},85:function(e,t,a){e.exports=a(139)}},[[85,1,2]]]);
//# sourceMappingURL=main.3849aff9.chunk.js.map