(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{136:function(e,t,a){},138:function(e,t,a){"use strict";a.r(t);a(85),a(110);var n=a(0),r=a.n(n),s=a(49),i=a.n(s),o=a(28),l=a.n(o),c=a(18),u=a(19),d=a(23),m=a(20),k=a(24),p=a(1),f=(a(35),a(36)),v=a.n(f),h=a(27),E=a.n(h),b=function(e){var t=e.router,a=e.onRemovableTasks,n=e.removable,s=E()("tasks"),i=s.dispatch,o=s.tasks,l=Object(p.platform)(),c=e.user.id;return console.log(o),r.a.createElement("div",null,r.a.createElement(p.PanelHeader,{left:l!==p.ANDROID&&r.a.createElement(p.HeaderButton,{onClick:function(){return a()}},r.a.createElement(v.a,null))},"\u0417\u0430\u043c\u0435\u0442\u043a\u0438"),r.a.createElement(p.List,null,o.map(function(e,a){return r.a.createElement(p.Cell,{expandable:!0,removable:n,key:a,onRemove:function(){return i("tasks/api/delete",{task:e,user_id:c})},onClick:function(){t.navigate("task",{id:e.id})}},e.text)})))},g=a(21),x=a.n(g),C=a(37),O=a.n(C),T=a(22),y=a.n(T),j=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).onClickAddTask=function(){var e=a.props.router,t=a.state.text;if(""!==t){a.setState({error:!1});a.props.tasks;var n=a.props.user.id;a.props.dispatch("tasks/api/add",{user_id:n,text:t}),e.navigateToDefault()}else a.setState({error:!0})},a.onChangeTextTask=function(e){var t=e.target.value;a.setState({text:t})},a.state={text:"",error:!1},a}return Object(k.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props.router,a=Object(p.platform)();return r.a.createElement("div",null,r.a.createElement(p.PanelHeader,{left:r.a.createElement(x.a,{onClick:function(){return t.navigate("tasks")}})},"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435"),r.a.createElement(p.FormLayout,null,!0===this.state.error&&r.a.createElement(p.FormStatus,{title:"\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0435 \u043f\u043e\u043b\u044f",state:"error"},"\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u044f"),r.a.createElement(p.Textarea,{onChange:this.onChangeTextTask,value:this.state.text,placeholder:"\u0417\u0434\u0435\u0441\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0412\u0430\u0448 \u0442\u0435\u043a\u0441\u0442"})),r.a.createElement(p.FixedLayout,{vertical:"bottom"},a===p.ANDROID?r.a.createElement(p.Div,{style:{float:"right"}},r.a.createElement(p.Button,{className:"FixedBottomButton",onClick:function(t){return e.onClickAddTask(t)}},r.a.createElement(O.a,null))):r.a.createElement(p.Div,null,r.a.createElement(p.Button,{size:"xl",onClick:function(t){return e.onClickAddTask(t)}},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"))))}}]),t}(r.a.Component),D=y()("tasks",j);var B=function(e){var t=E()("tasks").tasks.filter(function(t){return t.id===Number(e.route.params.id)})[0],a=e.router;return r.a.createElement("div",null,r.a.createElement(p.PanelHeader,{left:r.a.createElement(x.a,{onClick:function(){return a.navigate("tasks")}})},"\u0417\u0430\u0434\u0430\u0447\u0430"),"undefined"!==typeof t&&r.a.createElement(p.Group,null,r.a.createElement(p.Header,null,t.name),r.a.createElement(p.Div,null,t.text)))},N=a(83),S=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).onClickEditTask=function(){var e=a.props.router,t=a.state,n=t.id,r=t.text;if(""!==r){a.setState({error:!1});a.props.tasks;var s={id:n,text:r},i=a.props.user.id;a.props.dispatch("tasks/api/edit",{task:s,user_id:i}),e.navigate("task",{id:n})}else a.setState({error:!0})},a.onChangeTextTask=function(e){var t=e.target.value;a.setState({text:t})},a.state={id:null,text:"",error:!1},a}return Object(k.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.tasks.filter(function(t){return t.id===Number(e.props.route.params.id)})[0];this.setState(Object(N.a)({},t))}},{key:"render",value:function(){var e=this,t=this.props.router,a=Object(p.platform)();return r.a.createElement("div",null,r.a.createElement(p.PanelHeader,{left:r.a.createElement(x.a,{onClick:function(){return t.navigate("task",{id:e.state.id})}})},"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"),r.a.createElement(p.FormLayout,null,!0===this.state.error&&r.a.createElement(p.FormStatus,{title:"\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0435 \u043f\u043e\u043b\u044f",state:"error"},"\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u044f"),r.a.createElement(p.Textarea,{onChange:this.onChangeTextTask,value:this.state.text,placeholder:"\u041d\u0430\u043f\u0438\u0448\u0438, \u0447\u0442\u043e\u0431\u044b \u0442\u044b \u0445\u043e\u0442\u0435\u043b \u0441\u0434\u0435\u043b\u0430\u0442\u044c"})),r.a.createElement(p.FixedLayout,{vertical:"bottom"},a===p.ANDROID?r.a.createElement(p.Div,{style:{float:"right"}},r.a.createElement(p.Button,{className:"FixedBottomButton",onClick:function(){return e.onClickEditTask()}},r.a.createElement(O.a,null))):r.a.createElement(p.Div,null,r.a.createElement(p.Button,{size:"xl",onClick:function(){return e.onClickEditTask()}},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))))}}]),t}(r.a.Component),w=y()("tasks",S),P=a(77),R=a.n(P),F=a(78),I=a.n(F),A=a(38),V=(a(136),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).onRemovableTasks=function(){return a.setState({removable:!a.state.removable})},a.state={currentTaskId:null,removable:!1,user:{id:1}},a}return Object(k.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;l.a.subscribe(function(t){switch(t.detail.type){case"VKWebAppGetUserInfoResult":e.setState({user:t.detail.data});var a=t.detail.data.id;e.props.dispatch("tasks/api/get",{id:a});break;default:console.log(t.detail.type)}}),l.a.send("VKWebAppGetUserInfo",{})}},{key:"render",value:function(){var e=this,t=this.props,a=t.route,n=t.router,s=Object(p.platform)(),i="add"===a.name?"addView":"tasksView",o=a.name;return r.a.createElement(p.Root,{activeView:i},r.a.createElement(p.View,{activePanel:o,id:"tasksView"},r.a.createElement(p.Panel,{id:"tasks"},r.a.createElement(b,{user:this.state.user,router:n,removable:this.state.removable,onRemovableTasks:this.onRemovableTasks,setCurrentTaskId:this.setCurrentTaskId}),r.a.createElement(p.FixedLayout,{vertical:"bottom"},s===p.ANDROID?r.a.createElement(p.Div,{style:{float:"right"}},r.a.createElement(p.Button,{className:"FixedBottomButton",onClick:function(){return n.navigate("add")}},r.a.createElement(R.a,null))):r.a.createElement(p.Div,null,r.a.createElement(p.Button,{size:"xl",onClick:function(){return n.navigate("add")}},"\u041d\u043e\u0432\u0430\u044f \u0437\u0430\u043c\u0435\u0442\u043a\u0430")),s===p.ANDROID&&r.a.createElement(p.Div,null,r.a.createElement(p.Button,{className:"FixedBottomButton",onClick:function(){return e.onRemovableTasks()}},r.a.createElement(v.a,null))))),r.a.createElement(p.Panel,{id:"task"},r.a.createElement(B,{router:n,route:a}),r.a.createElement(p.FixedLayout,{vertical:"bottom"},s===p.ANDROID?r.a.createElement(p.Div,{style:{float:"right"}},r.a.createElement(p.Button,{className:"FixedBottomButton",onClick:function(){return n.navigate("edit",{id:a.params.id})}},r.a.createElement(I.a,null))):r.a.createElement(p.Div,null,r.a.createElement(p.Button,{size:"xl",onClick:function(){return n.navigate("edit",{id:a.params.id})}},"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c")))),r.a.createElement(p.Panel,{id:"edit",theme:"white"},r.a.createElement(w,{router:n,route:a,user:this.state.user}))),r.a.createElement(p.View,{activePanel:o,id:"addView"},r.a.createElement(p.Panel,{id:"add",theme:"white"},r.a.createElement(D,{user:this.state.user,router:n}))))}}]),t}(r.a.Component)),H=y()("tasks",function(e){return r.a.createElement(A.a,{nodeName:""},function(t){var a=t.route;return r.a.createElement(V,Object.assign({route:a},e))})}),L=a(29),_=a(80),z=a(81),J=[{name:"tasks",path:"/tasks"},{name:"task",path:"/task/:id"},{name:"edit",path:"/edit/:id"},{name:"add",path:"/add"}];var G=a(82),K=a.n(G),W="https://azshara-api.com",M=a(50),U=a.n(M);l.a.send("VKWebAppInit",{});var q=function(){var e=Object(L.b)(J,{defaultRoute:"tasks"});return e.usePlugin(_.a),e.usePlugin(Object(z.a)({useHash:!0})),e}(),Q=K()([function(e){e.on("@init",function(){return{tasks:[]}}),e.on("tasks/get",function(e,t){return e.tasks,{tasks:t.tsks}}),e.on("tasks/api/get",function(t,a){t.tasks;var n=a.id;fetch("".concat(W,"/notes/").concat(n)).then(function(e){return e.json()}).then(function(t){var a=t.notes;e.dispatch("tasks/get",{tsks:a})})}),e.on("tasks/api/add",function(e,t){var a=e.tasks;return fetch("".concat(W,"/add"),{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){console.log(e)}),{tasks:a.concat([t])}}),e.on("tasks/api/delete",function(e,t){var a=e.tasks,n=t.task,r=t.user_id;fetch("".concat(W,"/delete"),{method:"POST",body:JSON.stringify({id:n.id,user_id:r}),headers:{"Content-Type":"application/json"}});var s=n.id;return{tasks:a.filter(function(e){return e.id!==s})}}),e.on("tasks/api/edit",function(e,t){var a=e.tasks,n=t.task,r=t.user_id;return fetch("".concat(W,"/edit"),{method:"POST",body:JSON.stringify({id:n.id,text:n.text,user_id:r}),headers:{"Content-Type":"application/json"}}),{tasks:a.map(function(e){return e.id===n.id&&(e=n),e})}})}]);q.start(function(){i.a.render(r.a.createElement(A.b,{router:q},r.a.createElement(U.a.Provider,{value:Q},r.a.createElement(H,{router:q}))),document.getElementById("root"))})},84:function(e,t,a){e.exports=a(138)}},[[84,1,2]]]);
//# sourceMappingURL=main.effe2df7.chunk.js.map